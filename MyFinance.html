<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Finance App</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Roboto', sans-serif;
      background: #0f172a;
      color: #fff;
      scroll-behavior: smooth;
    }
    header {
      background: #1e293b;
      padding: 1em;
      text-align: center;
      font-size: 1.2em;
      font-weight: bold;
      color: #38bdf8;
      position: fixed;
      width: 100%;
      top: 0;
      z-index: 10;
    }
    main {
      padding: 1em;
      margin-top: 70px;
      margin-bottom: 80px;
    }
    .dashboard-card, .form-section, .tabungan-section {
      background: #1e293b;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 0 10px rgba(56,189,248,0.1);
      transition: transform 0.3s ease;
    }
    .dashboard-card:hover, .form-section:hover, .tabungan-section:hover {
      transform: translateY(-2px);
    }
    .dashboard-title, .form-section h3, .tabungan-section h3 {
      font-size: 1.1em;
      font-weight: bold;
      margin-bottom: 4px;
    }
    .dashboard-value {
      font-size: 1.6em;
      font-weight: bold;
      color: #38bdf8;
    }
    .tambah-saldo {
      background-color: #38bdf8;
      color: #0f172a;
      font-weight: bold;
      padding: 12px;
      border: none;
      width: 100%;
      border-radius: 10px;
      margin: 12px 0;
      font-size: 1em;
      box-shadow: 0 4px 10px rgba(56,189,248,0.3);
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: none;
      font-size: 1em;
    }
    input, select {
      background: #334155;
      color: #fff;
    }
    button {
      background: #38bdf8;
      color: #0f172a;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #0ea5e9;
    }
    .transaction-log {
      background: #1e293b;
      padding: 10px;
      margin: 10px 0;
      border-left: 4px solid #38bdf8;
      border-radius: 6px;
      transition: all 0.2s ease-in-out;
    }
    .log-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .log-date {
      font-size: 0.85em;
      color: #94a3b8;
    }
    .log-jenis.pemasukan {
      color: #4ade80;
      font-weight: bold;
    }
    .log-jenis.pengeluaran {
      color: #f87171;
      font-weight: bold;
    }
    .transaction-log i.material-icons {
      font-size: 18px;
      margin-right: 6px;
      vertical-align: middle;
      opacity: 0.8;
    }
    .transaction-log button {
      background: transparent;
      border: 1px solid #f87171;
      color: #f87171;
      border-radius: 6px;
      padding: 4px 10px;
      font-size: 0.85em;
      font-weight: bold;
      margin-top: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      transform: scale(1);
    }
    .transaction-log button:hover {
      background: #f87171;
      color: #0f172a;
      transform: scale(1.05);
    }
    canvas {
      background: #0f172a;
      border-radius: 10px;
      padding: 12px;
      width: 100%;
    }
    .bottom-nav {
      background: #1e293b;
      display: flex;
      justify-content: space-around;
      position: fixed;
      bottom: 0;
      width: 100%;
      border-top: 1px solid #334155;
    }
    .bottom-nav button {
      background: none;
      border: none;
      color: #cbd5e1;
      padding: 10px;
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: color 0.3s;
    }
    .bottom-nav button.active, .bottom-nav button:hover {
      color: #38bdf8;
    }
    .material-icons { font-size: 20px; }
    .page {
      display: none;
      opacity: 0;
      transform: translateX(20px);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    .active-page {
      display: block;
      opacity: 1;
      transform: translateX(0);
    }
  </style>
</head>
<body>
  <header>Finance App</header>
  <main>
    <section id="dashboard" class="page active-page">
      <div class="dashboard-card">
        <div class="dashboard-title">Total Saldo Aktif</div>
        <div class="dashboard-value" id="saldoAktif">Rp 0</div>
      </div>
      <button class="tambah-saldo" onclick="navigateTo('cashflow')">Tambah Saldo</button>
      <div class="dashboard-card">
        <div class="dashboard-title">Pemasukan Bulan Ini</div>
        <div class="dashboard-value" id="pemasukanBulanIni">Rp 0</div>
      </div>
      <div class="dashboard-card">
        <div class="dashboard-title">Pengeluaran Bulan Ini</div>
        <div class="dashboard-value" id="pengeluaranBulanIni">Rp 0</div>
      </div>
      <div class="dashboard-card">
        <div class="dashboard-title">Grafik Cashflow</div>
        <canvas id="cashflowChart" height="150"></canvas>
      </div>
    </section>
    <section id="cashflow" class="page">
      <div class="form-section">
        <h3>Tambah Transaksi</h3>
        <form id="formTambahTransaksi">
          <input type="text" id="deskripsi" placeholder="Deskripsi" required>
          <input type="number" id="jumlah" placeholder="Jumlah (Rp)" required>
          <input type="date" id="tanggal" required>
          <select id="jenis" required>
            <option value="">-- Jenis --</option>
            <option value="pemasukan">Pemasukan</option>
            <option value="pengeluaran">Pengeluaran</option>
          </select>
          <input type="text" id="keinginan" placeholder="Keinginan (opsional)">
          <button type="submit">Tambah</button>
        </form>
      </div>
      <div class="form-section">
        <h3>Riwayat Transaksi</h3>
        <div id="riwayatTransaksi"></div>
      </div>
    </section>

    <section id="tabungan" class="page">
      <div class="tabungan-section">
        <h3>Simulasi Tabungan</h3>
        <input type="number" id="targetJumlah" placeholder="Target tabungan (Rp)">
        <input type="number" id="jangkaWaktu" placeholder="Jangka waktu (bulan)">
        <button onclick="hitungTabungan()">Hitung</button>
        <div id="hasilTabungan"></div>
      </div>
    </section>
  </main>

  <div class="bottom-nav">
    <button class="nav-link active" data-target="dashboard"><span class="material-icons">dashboard</span>Dashboard</button>
    <button class="nav-link" data-target="cashflow"><span class="material-icons">swap_vert</span>Cashflow</button>
    <button class="nav-link" data-target="tabungan"><span class="material-icons">savings</span>Tabungan</button>
  </div>
  <script>
    const navLinks = document.querySelectorAll('.nav-link');
    const pages = document.querySelectorAll('.page');
    let transaksi = JSON.parse(localStorage.getItem('transaksi')) || [];

    function navigateTo(target) {
      navLinks.forEach(l => l.classList.remove('active'));
      document.querySelector(`.nav-link[data-target="${target}"]`)?.classList.add('active');
      pages.forEach(p => p.classList.remove('active-page'));
      document.getElementById(target)?.classList.add('active-page');
      if (target === 'dashboard') updateDashboard();
      if (target === 'cashflow') renderRiwayat();
    }

    navLinks.forEach(link => {
      link.addEventListener('click', () => navigateTo(link.dataset.target));
    });

    document.getElementById('formTambahTransaksi').addEventListener('submit', e => {
      e.preventDefault();
      const t = {
        deskripsi: deskripsi.value,
        jumlah: +jumlah.value,
        tanggal: tanggal.value,
        jenis: jenis.value,
        keinginan: keinginan.value
      };
      transaksi.push(t);
      localStorage.setItem('transaksi', JSON.stringify(transaksi));
      e.target.reset();
      renderRiwayat();
      updateDashboard();
    });

    function renderRiwayat() {
      const log = document.getElementById('riwayatTransaksi');
      log.innerHTML = '';
      transaksi.forEach((t, i) => {
        log.innerHTML += `<div class='transaction-log'>
          <div class='log-head'>
            <b><i class='material-icons'>receipt_long</i> ${t.deskripsi}</b>
            <span class='log-date'>${new Date(t.tanggal).toLocaleDateString('id-ID')}</span>
          </div>
          <div class='log-body'>
            <span class='log-jenis ${t.jenis}'><i class='material-icons'>${t.jenis === 'pemasukan' ? 'arrow_downward' : 'arrow_upward'}</i>${t.jenis}</span>
            â€¢ Rp ${t.jumlah.toLocaleString('id-ID')}<br>
            ${t.keinginan ? `<small>Keinginan: ${t.keinginan}</small><br>` : ''}
            <button onclick="hapusTransaksi(${i})">Hapus</button>
          </div>
        </div>`;
      });
    }

    function hapusTransaksi(i) {
      if (confirm('Yakin ingin menghapus transaksi ini?')) {
        transaksi.splice(i, 1);
        localStorage.setItem('transaksi', JSON.stringify(transaksi));
        renderRiwayat();
        updateDashboard();
      }
    }

    function updateDashboard() {
      const now = new Date();
      let saldo = 0, inBulan = 0, outBulan = 0;
      const m = now.getMonth(), y = now.getFullYear();

      transaksi.forEach(t => {
        const d = new Date(t.tanggal);
        if (t.jenis === 'pemasukan') saldo += t.jumlah;
        else saldo -= t.jumlah;
        if (d.getMonth() === m && d.getFullYear() === y) {
          if (t.jenis === 'pemasukan') inBulan += t.jumlah;
          else outBulan += t.jumlah;
        }
      });

      saldoAktif.textContent = 'Rp ' + saldo.toLocaleString('id-ID');
      pemasukanBulanIni.textContent = 'Rp ' + inBulan.toLocaleString('id-ID');
      pengeluaranBulanIni.textContent = 'Rp ' + outBulan.toLocaleString('id-ID');
      renderChart();
    }

    function renderChart() {
      const ctx = document.getElementById('cashflowChart').getContext('2d');
      const now = new Date();
      const labels = [], pemasukan = [], pengeluaran = [];
      for (let i = 5; i >= 0; i--) {
        const d = new Date(now.getFullYear(), now.getMonth() - i, 1);
        const label = d.toLocaleString('id-ID', { month: 'short' });
        labels.push(label);
        let inTotal = 0, outTotal = 0;
        transaksi.forEach(t => {
          const dt = new Date(t.tanggal);
          if (dt.getMonth() === d.getMonth() && dt.getFullYear() === d.getFullYear()) {
            if (t.jenis === 'pemasukan') inTotal += t.jumlah;
            else outTotal += t.jumlah;
          }
        });
        pemasukan.push(inTotal);
        pengeluaran.push(outTotal);
      }
      if (window.myChart) window.myChart.destroy();
      window.myChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels,
          datasets: [
            { label: 'Pemasukan', data: pemasukan, borderColor: '#38bdf8', fill: true },
            { label: 'Pengeluaran', data: pengeluaran, borderColor: '#f87171', fill: true }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { labels: { color: '#fff' } } },
          scales: {
            x: { ticks: { color: '#fff' }, grid: { color: '#334155' } },
            y: { ticks: { color: '#fff' }, grid: { color: '#334155' } }
          }
        }
      });
    }

    function hitungTabungan() {
      const target = +document.getElementById('targetJumlah').value;
      const bulan = +document.getElementById('jangkaWaktu').value;
      const hari = bulan * 30;
      if (!target || !bulan) return hasilTabungan.textContent = 'Mohon isi semua data';
      const perHari = Math.ceil(target / hari);
      hasilTabungan.textContent = `Kamu perlu menabung Rp ${perHari.toLocaleString('id-ID')} per hari.`;
    }

    updateDashboard();
    renderRiwayat();
  </script>
</body>
</html>